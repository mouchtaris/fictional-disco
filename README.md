# fictional-disco

## Prerequisites

* [AzureCLI 2.0 (python version)](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest)
* [Terraform >= 0.11.7](https://www.terraform.io/downloads.html)

## Instructions

* Install Azure CLI -- add to `PATH`
* Install Terraform -- add to `PATH`
* Login to Azure: `az login --use-device-code`
* Generate terraform plan: `bin/plan` (or `terraform -out=plan.tfplan -var-file=input.tfvars tf`)
* Apply terraform plan: `bin/apply` (or `terraform apply plan.tfplan`)
* Destroy: `bin/destroy` (or `terraform destroy`)
* Enjoy

## Assumptions

* Storage account replication type: no information is provided for the assignment, so the simplest, cheapest method
  is chose (Local Redundant Storage).
* Restriction policies:
  * It is assumed that *all* resources under compute, network and storage are allowed
  * It is assumed that the *current* available resources are allowed
  * No provision for future added or removed resources
  
## Configurability

The following properties are configurable by editing `input.tfvars`:
* Virtual network address space
* Virtual network number of subnets
* Tags applied to the resource group

After editing this file, run `bin/plan` to see the resources that would be recreated. `bin/apply` will apply those
changes.

## Extras

Ruby scripts were used for side-effects. Instructions for using the ruby scripts

* `bundle install`

### Azure Hell

Azure types of resource and built in policies are listed nowhere in documentation. They were fetched manually through the
REST api. A small ruby script was built to extract information from those responses. `bin/azdb` lists available options
for extracting information from JSON files found under `azure.db`.

### Timelog

The timelog is included as a JSON file, under `timelog.json`. This file is generated by `bin/generate_timelog`, which soures
information from the `timelog` directory.
